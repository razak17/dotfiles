# -----------------------------------------------------------------------------
# Key bindings
# -----------------------------------------------------------------------------
MAIN_CONF="$HOME/.config/tmux/tmux.conf"

# Launchers
bind -n M-/ split-window -h "nvim"
bind -n M-f split-window -h "ranger"


# Session-wide
bind -N "Reload config" r source-file $MAIN_CONF \; display "Tmux config file Reloaded!"
bind -N "New window"    W command-prompt "new-window -c '#{pane_current_path}' -n %1"
bind -N "New session"   S command-prompt "new-session -c '#{pane_current_path}' -s %%"
bind -N "Detach client" d confirm-before -p " Detach this client? (y/n)" detach-client
bind -N "Kill session"  Q confirm-before -p " Kill-session #S? (y/n)" kill-session
bind -N "Kill window"   X confirm-before -p " Kill window #W? (y/n)" kill-window
bind -N "Kill pane"     x confirm-before -p " Kill pane #P? (y/n)" kill-pane
bind -N "Go to next window"     n next-window
bind -N "Go to previous window" b previous-window
bind -N "Kill all widows except current" C-x confirm-before -p " Kill all other windows? (y/n)" "kill-window -a"
bind c neww -c "#{pane_current_path}"

# Open new panes in the current directory
bind -N "Split window horizontally in pwd" h split-window -p 40 -c "#{pane_current_path}"
bind -N "Split window vertically in pwd"   v split-window -p 45 -c "#{pane_current_path}" -h

# Move between panes and windows
bind -N "Select the pane to the left the active pane"  -r C-h select-pane -LZ
bind -N "Select the pane below the active pane"        -r C-n select-pane -DZ
bind -N "Select the pane above the active pane"        -r C-k select-pane -UZ
bind -N "Select the pane to the right the active pane" -r C-l select-pane -RZ
bind -N "Select the last window"                       -r l   last-window
bind -N "Select the last pane"                         -r y   last-pane -Z
bind -N "Go to next pane"                                 ";" run "ftmux --nextpane"
bind -N "Go to previous pane"                             "," run "ftmux --prevpane"

# Resize panes
bind -N "Resize current pane down by 2"  O resize-pane -D 2
bind -N "Resize current pane up by 2"    K resize-pane -U 2
bind -N "Resize current pane left by 4"  H resize-pane -L 4
bind -N "Resize current pane right by 4" L resize-pane -R 4

# TODO Toggle status bar bg
bind C-b set-option status
# bind -N "Remove status bar color" B set-option -g status-style bg=default
# bind -N "Add status bar color" C set-option -g status-style bg=$BG_COLOR

# Rename session and window
# bind R command-prompt -I "#{session_name}" "rename-session '%%'"
bind R respawn-pane -k
# bind M-r command-prompt -I "#{window_name}" "rename-window '%%'"

# Swap window
bind < swap-window -t -1
bind > swap-window -t +1

# Swap panels
bind -r "'" swap-pane -D
bind -r [ swap-pane -U
bind -r k switch-client -p
bind -r j switch-client -n
bind -r N switch-client -l

# rotate window
bind C-i rotate-window -DZ
bind C-o rotate-window -UZ

# Copy to system clipboard
bind C-m copy-mode
bind M-v paste-buffer
bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi V send-keys -X select-line
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel 'xclip -in -selection clipboard'
bind -T copy-mode-vi MouseDown1Pane send-keys -X clear-selection
bind -T copy-mode-vi MouseDown3Pane send-keys -X cancel
bind -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe 'xclip -in -selection clipboard'
bind -T copy-mode-vi n send-keys -X cursor-down

# treE
bind a run 'tmux choose-tree -NwZf"##{==:##{session_name},#{session_name}}"'
bind s run 'tmux choose-tree -sZ'

# Select window
# bind o select-window -t 1
bind 0 select-window -t 0
bind 2 select-window -t 2
bind i select-window -t 3
bind 4 select-window -t 4
bind 5 select-window -t 5
bind 6 select-window -t 6
bind 7 select-window -t 7
bind 8 select-window -t 8
bind 9 select-window -t 9

# misc
bind c-w next-layout
bind space resize-pane -Z
bind C-e display-panes -d 2000 "select-pane -t '%%'"

# Script binds
bind "=" run "ftmux -r" # Up to 4 panes
bind B run "ftmux -b"

